{"version":3,"file":"update.js","sources":["../../../src/utils/update.ts"],"sourcesContent":["import type { Obj } from '../types';\nimport { _cloneDeep } from './cloneDeep';\nimport { _isPlainObject } from './isPlainObject';\n\n/** @ignore */\nexport function _update<Data extends Obj>(\n  obj: Data | undefined,\n  path: string | string[],\n  updater: (value: any) => any\n) {\n  if (obj) obj = _cloneDeep<Data>(obj);\n  if (!_isPlainObject(obj)) obj = {} as Data;\n  const splitPath = !Array.isArray(path) ? path.match(/[^.[\\]]+/g) || [] : path;\n  const lastSection = splitPath[splitPath.length - 1];\n  if (!lastSection) return obj;\n  let property: any = obj;\n  for (let i = 0; i < splitPath.length - 1; i++) {\n    const section = splitPath[i];\n    if (\n      !property[section] ||\n      (!_isPlainObject(property[section]) && !Array.isArray(property[section]))\n    ) {\n      const nextSection = splitPath[i + 1];\n      if (isNaN(Number(nextSection))) {\n        property[section] = {};\n      } else {\n        property[section] = [];\n      }\n    }\n    property = property[section];\n  }\n  property[lastSection] = updater(property[lastSection]);\n  return obj;\n}\n"],"names":[],"mappings":";;;AAIA;SACgB,OAAO,CACrB,GAAqB,EACrB,IAAuB,EACvB,OAA4B;IAE5B,IAAI,GAAG;QAAE,GAAG,GAAG,UAAU,CAAO,GAAG,CAAC,CAAC;IACrC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC;QAAE,GAAG,GAAG,EAAU,CAAC;IAC3C,MAAM,SAAS,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC;IAC9E,MAAM,WAAW,GAAG,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IACpD,IAAI,CAAC,WAAW;QAAE,OAAO,GAAG,CAAC;IAC7B,IAAI,QAAQ,GAAQ,GAAG,CAAC;IACxB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;QAC7C,MAAM,OAAO,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;QAC7B,IACE,CAAC,QAAQ,CAAC,OAAO,CAAC;aACjB,CAAC,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,EACzE;YACA,MAAM,WAAW,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACrC,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE;gBAC9B,QAAQ,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;aACxB;iBAAM;gBACL,QAAQ,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;aACxB;SACF;QACD,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;KAC9B;IACD,QAAQ,CAAC,WAAW,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;IACvD,OAAO,GAAG,CAAC;AACb;;;;"}