{"version":3,"file":"index.cjs","sources":["../../src/get.ts","../../src/error.ts","../../src/create-field.ts","../../../../node_modules/.pnpm/tslib@2.3.1/node_modules/tslib/tslib.es6.js","../../src/deep-set-touched.ts","../../src/deep-set-key.ts","../../src/helpers.ts","../../src/events.ts","../../src/create-form-action.ts","../../src/stores.ts","../../src/create-form.ts"],"sourcesContent":["import type { Readable } from 'svelte/store';\n\nfunction subscribe(store: any, ...callbacks: any[]) {\n  const unsub = store.subscribe(...callbacks);\n  return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\n\ntype Store<Data> =\n  | Readable<Data>\n  | {\n      subscribe(subscriber: (value: Data) => void): { unsubscribe(): void };\n    };\n\nexport function get<Data>(store: Store<Data>): Data {\n  let value: Data | undefined = undefined;\n  subscribe(store, (_: Data) => (value = _))();\n  return (value as unknown) as Data;\n}\n","export type FailResponse = Omit<Response, 'ok'> & {\n  ok: false;\n};\n\nexport type SuccessResponse = Omit<Response, 'ok'> & {\n  ok: true;\n};\n\nexport type FetchResponse = SuccessResponse | FailResponse;\n\nexport class FelteSubmitError extends Error {\n  constructor(message: string, response: FailResponse) {\n    super(message);\n    this.name = 'FelteSubmitError';\n    this.response = response;\n  }\n  response: FailResponse;\n}\n","import type { FieldValue, FormControl } from '@felte/common';\nimport { isFormControl, setControlValue, isElement } from '@felte/common';\n\nexport type FieldConfig = {\n  name: string;\n  touchOnChange?: boolean;\n  defaultValue?: FieldValue;\n  onFormReset?(e: ResetEvent): void;\n};\n\nexport type Field = {\n  field(node: HTMLElement): { destroy?(): void };\n  onInput(value: FieldValue): void;\n  onChange(value: FieldValue): void;\n  onBlur(): void;\n};\n\ntype EventType = 'input' | 'change' | 'focusout';\n\ntype ResetEvent = Event & { target: HTMLFormElement };\n\nconst observerConfig = {\n  attributes: true,\n  attributeFilter: ['data-felte-validation-message', 'aria-invalid'],\n};\n\nexport function createField(\n  name: string,\n  config?: Omit<FieldConfig, 'name'>\n): Field;\nexport function createField(config: FieldConfig): Field;\nexport function createField(\n  nameOrConfig: FieldConfig | string,\n  config?: Omit<FieldConfig, 'name'>\n): Field;\nexport function createField(\n  nameOrConfig: FieldConfig | string,\n  config?: Omit<FieldConfig, 'name'>\n): Field {\n  let name: string;\n  let defaultValue: FieldValue;\n  let touchOnChange: boolean;\n  let fieldNode: HTMLElement;\n  let control: FormControl;\n  let onFormReset: ((e: ResetEvent) => void) | undefined;\n\n  if (typeof nameOrConfig === 'string') {\n    name = nameOrConfig;\n    defaultValue = config?.defaultValue;\n    touchOnChange = config?.touchOnChange ?? false;\n    onFormReset = config?.onFormReset;\n  } else {\n    name = nameOrConfig.name;\n    defaultValue = nameOrConfig.defaultValue;\n    touchOnChange = nameOrConfig.touchOnChange ?? false;\n    onFormReset = nameOrConfig?.onFormReset;\n  }\n\n  function dispatchEvent(eventType: 'focusout'): void;\n  function dispatchEvent(\n    eventType: 'input' | 'change',\n    value: FieldValue\n  ): void;\n  function dispatchEvent(eventType: EventType, value?: FieldValue): void {\n    if (!control) return;\n    setControlValue(control, value);\n    const customEvent = new Event(eventType, {\n      bubbles: true,\n      composed: true,\n    });\n    control.dispatchEvent(customEvent);\n  }\n\n  function mutationCallback(mutationList: MutationRecord[]) {\n    mutationList.forEach(() => {\n      const invalid = control.getAttribute('aria-invalid');\n      if (!invalid) fieldNode.removeAttribute('aria-invalid');\n      else fieldNode.setAttribute('aria-invalid', invalid);\n      const validationMessage = control.getAttribute(\n        'data-felte-validation-message'\n      );\n      if (!validationMessage)\n        fieldNode.removeAttribute('data-felte-validation-message');\n      else\n        fieldNode.setAttribute(\n          'data-felte-validation-message',\n          validationMessage\n        );\n    });\n  }\n\n  function handleReset(e: Event) {\n    if (!onFormReset) return;\n    setControlValue(control, defaultValue);\n    onFormReset(e as ResetEvent);\n  }\n\n  function field(node: HTMLElement) {\n    fieldNode = node;\n    let observer: MutationObserver;\n    let formElement: HTMLFormElement | null;\n    if (isFormControl(node)) {\n      control = node;\n      control.name = name;\n      return {};\n    } else {\n      // This setTimeout is necessary to guarantee the node has been mounted\n      let created = false;\n      let destroyed = false;\n      setTimeout(() => {\n        if (destroyed) return;\n        const parent = fieldNode.parentNode;\n        if (!parent || !isElement(parent)) return;\n        const foundControl = parent.querySelector(`[name=\"${name}\"]`);\n        if (!foundControl || !isFormControl(foundControl)) {\n          const input = document.createElement('input');\n          input.type = 'hidden';\n          input.name = name;\n          parent.insertBefore(input, node.nextSibling);\n          control = input;\n          created = true;\n        } else {\n          control = foundControl;\n        }\n        setControlValue(control, defaultValue);\n\n        observer = new MutationObserver(mutationCallback);\n        observer.observe(control, observerConfig);\n        formElement = control.closest('form');\n        formElement?.addEventListener('reset', handleReset);\n      });\n      return {\n        destroy() {\n          if (created) control.parentNode?.removeChild(control);\n          destroyed = true;\n          observer?.disconnect();\n          formElement?.removeEventListener('reset', handleReset);\n        },\n      };\n    }\n  }\n\n  function onInput(value: FieldValue) {\n    dispatchEvent(touchOnChange ? 'change' : 'input', value);\n  }\n\n  function onBlur() {\n    dispatchEvent('focusout');\n  }\n  return {\n    field,\n    onInput,\n    onChange: onInput,\n    onBlur,\n  };\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import type { Obj, Touched, Keyed } from '@felte/common';\nimport { _mapValues, _isPlainObject } from '@felte/common';\n\nexport function deepSetTouched<Data extends Obj>(\n  obj: Data | Keyed<Data>,\n  value: boolean\n): Touched<Data> {\n  return _mapValues(obj, (prop) => {\n    if (_isPlainObject(prop)) return deepSetTouched(prop as Obj, value);\n    if (Array.isArray(prop)) {\n      if (prop.length === 0 || prop.every((p) => typeof p === 'string'))\n        return value;\n      return prop.map((p) => {\n        const { key, ...field } = deepSetTouched(p as Obj, value);\n        return field;\n      });\n    }\n    return value;\n  }) as Touched<Data>;\n}\n","import type { Obj, Keyed } from '@felte/common';\nimport { _mapValues, _isPlainObject, createId } from '@felte/common';\n\nexport function deepSetKey<Data extends Obj>(obj?: Data): Data {\n  if (!obj) return {} as Data;\n  return _mapValues(obj, (prop) => {\n    if (_isPlainObject(prop)) return deepSetKey(prop as Obj);\n    if (Array.isArray(prop)) {\n      if (prop.length === 0 || prop.every((p) => typeof p === 'string'))\n        return prop;\n      return prop.map((p) => {\n        if (!_isPlainObject(p)) return p;\n        const field = deepSetKey(p as Obj);\n        if (!field.key) field.key = createId();\n        return field;\n      });\n    }\n    return prop;\n  }) as Data;\n}\n\nexport function deepRemoveKey<Data extends Obj>(\n  obj?: Keyed<Data> | Data\n): Data {\n  if (!obj) return {} as Data;\n  return _mapValues(obj, (prop) => {\n    if (_isPlainObject(prop)) return deepSetKey(prop as Obj);\n    if (Array.isArray(prop)) {\n      if (prop.length === 0 || prop.every((p) => typeof p === 'string'))\n        return prop;\n      return prop.map((p) => {\n        if (!_isPlainObject(p)) return p;\n        const { key, ...field } = deepSetKey(p as Obj);\n        return field;\n      });\n    }\n    return prop;\n  }) as Data;\n}\n","import type {\n  Errors,\n  Extender,\n  FieldValue,\n  FormConfig,\n  Obj,\n  Stores,\n  Touched,\n  ValidationFunction,\n  TransformFunction,\n  Setter,\n  ObjectSetter,\n  PartialErrorsSetter,\n  AssignableErrors,\n  PrimitiveSetter,\n  FieldsSetter,\n  Helpers,\n  Keyed,\n} from '@felte/common';\nimport {\n  deepSet,\n  setForm,\n  _cloneDeep,\n  _get,\n  _set,\n  _unset,\n  _update,\n  _isPlainObject,\n  createId,\n} from '@felte/common';\nimport { get } from './get';\nimport { deepSetTouched } from './deep-set-touched';\nimport { deepSetKey } from './deep-set-key';\n\ntype CreateHelpersOptions<Data extends Obj> = {\n  config: FormConfig<Data>;\n  stores: Stores<Data>;\n  validateErrors(data: Data | Keyed<Data>): Promise<Errors<Data> | undefined>;\n  validateWarnings(data: Data | Keyed<Data>): Promise<Errors<Data> | undefined>;\n  extender: Extender<Data>[];\n  addValidator(validator: ValidationFunction<Data>): void;\n  addTransformer(transformer: TransformFunction<Data>): void;\n};\n\nfunction addAtIndex<Data extends Obj>(\n  storeValue: Data,\n  path: string,\n  value: any,\n  index?: number\n) {\n  return _update(storeValue, path, (oldValue) => {\n    if (typeof oldValue !== 'undefined' && !Array.isArray(oldValue))\n      return oldValue;\n    if (!oldValue) oldValue = [];\n    if (typeof index === 'undefined') {\n      oldValue.push(value);\n    } else {\n      oldValue.splice(index, 0, value);\n    }\n    return oldValue;\n  });\n}\n\nfunction swapInArray<Data extends Obj>(\n  storeValue: Data,\n  path: string,\n  from: number,\n  to: number\n) {\n  return _update(storeValue, path, (oldValue) => {\n    if (!oldValue || !Array.isArray(oldValue)) return oldValue;\n    [oldValue[from], oldValue[to]] = [oldValue[to], oldValue[from]];\n    return oldValue;\n  });\n}\n\nfunction moveInArray<Data extends Obj>(\n  storeValue: Data,\n  path: string,\n  from: number,\n  to: number\n) {\n  return _update(storeValue, path, (oldValue) => {\n    if (!oldValue || !Array.isArray(oldValue)) return oldValue;\n    oldValue.splice(to, 0, oldValue.splice(from, 1)[0] as any);\n    return oldValue;\n  });\n}\n\nfunction isUpdater<T>(value: unknown): value is (value: T) => T {\n  return typeof value === 'function';\n}\n\nfunction createSetHelper<Data extends Obj, Path extends string>(\n  storeSetter: (\n    updater: (value: Errors<Data>) => AssignableErrors<Data>\n  ) => void\n): PartialErrorsSetter<Data, Path>;\nfunction createSetHelper<Data extends Obj, Path extends string>(\n  storeSetter: (updater: (value: Data) => Data) => void\n): ObjectSetter<Data, Path>;\nfunction createSetHelper<Data extends boolean | string | null>(\n  storeSetter: (updater: (value: Data) => Data) => void\n): PrimitiveSetter<Data>;\nfunction createSetHelper<Data extends Obj | boolean>(\n  storeSetter: (updater: (value: Data) => Data) => void\n): Setter<Data> {\n  const setHelper = (\n    pathOrValue: string | Data | ((value: Data) => Data),\n    valueOrUpdater?: unknown | ((value: unknown) => unknown)\n  ) => {\n    if (typeof pathOrValue === 'string') {\n      const path = pathOrValue;\n      storeSetter((oldValue) => {\n        const newValue = isUpdater(valueOrUpdater)\n          ? (valueOrUpdater(_get(oldValue as Obj, path)) as Data)\n          : valueOrUpdater;\n        return _set(\n          oldValue as Obj,\n          path,\n          newValue as FieldValue | FieldValue[]\n        ) as Data;\n      });\n    } else {\n      storeSetter((oldValue) =>\n        isUpdater<Data>(pathOrValue) ? pathOrValue(oldValue) : pathOrValue\n      );\n    }\n  };\n\n  return setHelper as Setter<Data>;\n}\n\nexport function createHelpers<Data extends Obj>({\n  stores,\n  config,\n  validateErrors,\n  validateWarnings,\n}: CreateHelpersOptions<Data>) {\n  let formNode: HTMLFormElement | undefined;\n  let initialValues = deepSetKey((config.initialValues ?? {}) as Data);\n\n  const {\n    data,\n    touched,\n    errors,\n    warnings,\n    isDirty,\n    isSubmitting,\n    interacted,\n  } = stores;\n\n  const setData = createSetHelper<Data, string>(data.update);\n\n  const setTouched = createSetHelper<Touched<Data>, string>(touched.update);\n\n  const setErrors = createSetHelper<Data, string>(errors.update);\n\n  const setWarnings = createSetHelper<Data, string>(warnings.update);\n\n  function updateFields(updater: (values: Data) => Data) {\n    setData((oldData) => {\n      const newData = updater(oldData);\n      if (formNode) setForm(formNode, newData);\n      return newData;\n    });\n  }\n\n  const setFields: FieldsSetter<Data, string> = (\n    pathOrValue: string | Data | ((value: Data) => Data),\n    valueOrUpdater?: unknown | ((value: unknown) => unknown),\n    shouldTouch?: boolean\n  ) => {\n    const fieldsSetter = createSetHelper<Data, string>(updateFields);\n    fieldsSetter(pathOrValue as any, valueOrUpdater as any);\n    if (typeof pathOrValue === 'string' && shouldTouch) {\n      setTouched<string, any>(pathOrValue, true);\n    }\n  };\n\n  function addField(path: string, value: unknown, index?: number) {\n    const touchedValue = _isPlainObject(value)\n      ? deepSetTouched(value, false)\n      : false;\n    const errValue = _isPlainObject(touchedValue)\n      ? deepSet(touchedValue, [])\n      : [];\n    value = _isPlainObject(value) ? { ...value, key: createId() } : value;\n    errors.update(($errors) => {\n      return addAtIndex($errors, path, errValue, index);\n    });\n    warnings.update(($warnings) => {\n      return addAtIndex($warnings, path, errValue, index);\n    });\n    touched.update(($touched) => {\n      return addAtIndex($touched, path, touchedValue, index);\n    });\n    data.update(($data) => {\n      const newData = addAtIndex($data, path, value, index);\n      setTimeout(() => formNode && setForm(formNode, newData));\n      return newData;\n    });\n  }\n\n  function updateAll(updater: <Data extends Obj>(storeValue: Data) => Data) {\n    errors.update(updater);\n    warnings.update(updater);\n    touched.update(updater);\n    data.update(($data) => {\n      const newData = updater($data);\n      setTimeout(() => formNode && setForm(formNode, newData));\n      return newData;\n    });\n  }\n\n  function unsetField(path: string) {\n    updateAll((storeValue) => _unset(storeValue, path));\n  }\n\n  function swapFields(path: string, from: number, to: number) {\n    updateAll((storeValue) => swapInArray(storeValue, path, from, to));\n  }\n\n  function moveField(path: string, from: number, to: number) {\n    updateAll((storeValue) => moveInArray(storeValue, path, from, to));\n  }\n\n  function resetField(path: string) {\n    const initialValue = _get(initialValues, path);\n    const touchedValue: any = _isPlainObject(initialValue)\n      ? deepSetTouched(initialValue as Obj, false)\n      : false;\n    const errValue: any = _isPlainObject(touchedValue)\n      ? deepSet(touchedValue, [])\n      : [];\n    data.update(($data) => {\n      const newData = _set($data, path, initialValue);\n      if (formNode) setForm(formNode, newData);\n      return newData;\n    });\n    touched.update(($touched) => {\n      return _set($touched, path, touchedValue);\n    });\n    errors.update(($errors) => {\n      return _set($errors, path, errValue);\n    });\n    warnings.update(($warnings) => {\n      return _set($warnings, path, errValue);\n    });\n  }\n\n  const setIsSubmitting = createSetHelper(isSubmitting.update);\n\n  const setIsDirty = createSetHelper(isDirty.update);\n\n  const setInteracted = createSetHelper(interacted.update);\n\n  async function validate(): Promise<Errors<Data> | void> {\n    const currentData = get(data);\n    touched.set(deepSetTouched(currentData, true));\n    interacted.set(null);\n    const currentErrors = await validateErrors(currentData);\n    await validateWarnings(currentData);\n    return currentErrors;\n  }\n\n  function reset(): void {\n    setFields(_cloneDeep(initialValues));\n    setTouched(($touched) => deepSet($touched, false) as Touched<Data>);\n    interacted.set(null);\n    isDirty.set(false);\n  }\n\n  const publicHelpers: Helpers<Data> = {\n    setData,\n    setFields,\n    setTouched,\n    setErrors,\n    setWarnings,\n    setIsSubmitting,\n    setIsDirty,\n    setInteracted,\n    validate,\n    reset,\n    unsetField,\n    resetField,\n    addField,\n    swapFields,\n    moveField,\n    setInitialValues: (values: Data) => {\n      initialValues = deepSetKey(values);\n    },\n  };\n\n  const privateHelpers = {\n    _setFormNode(node: HTMLFormElement) {\n      formNode = node;\n    },\n    _getFormNode: () => formNode,\n    _getInitialValues: () => initialValues,\n  };\n\n  return {\n    public: publicHelpers,\n    private: privateHelpers,\n  };\n}\n","import type {\n  SubmitContext,\n  Obj,\n  CreateSubmitHandlerConfig,\n  AssignableErrors,\n} from '@felte/common';\n\nexport type FelteSuccessDetail<Data extends Obj = Obj> = SubmitContext<Data> & {\n  response: unknown;\n};\n\nexport type FelteErrorDetail<Data extends Obj = Obj> = SubmitContext<Data> & {\n  error: unknown;\n};\n\nexport type FelteSuccessEvent<Data extends Obj = any> = CustomEvent<\n  FelteSuccessDetail<Data>\n>;\n\nexport type FelteErrorEvent<Data extends Obj = any> = CustomEvent<\n  FelteErrorDetail<Data>\n> & {\n  errors?: AssignableErrors<Data>;\n\n  setErrors(errors: AssignableErrors<Data>): void;\n};\n\nexport type FelteSubmitEvent<Data extends Obj = any> = Event & {\n  target: HTMLFormElement;\n  onSubmit?: CreateSubmitHandlerConfig<Data>['onSubmit'];\n  onError?: CreateSubmitHandlerConfig<Data>['onError'];\n  onSuccess?: CreateSubmitHandlerConfig<Data>['onSuccess'];\n\n  handleSubmit(onSubmit: CreateSubmitHandlerConfig<Data>['onSubmit']): void;\n\n  handleError(onError: CreateSubmitHandlerConfig<Data>['onError']): void;\n\n  handleSuccess(onSuccess: CreateSubmitHandlerConfig<Data>['onSuccess']): void;\n};\n\nexport function createEventConstructors<Data extends Obj = any>() {\n  class SuccessEvent<Data extends Obj = any> extends CustomEvent<\n    FelteSuccessDetail<Data>\n  > {\n    constructor(detail: FelteSuccessDetail<Data>) {\n      super('feltesuccess', { detail });\n    }\n  }\n\n  class ErrorEvent<Data extends Obj = any> extends CustomEvent<\n    FelteErrorDetail<Data>\n  > {\n    constructor(detail: FelteErrorDetail<Data>) {\n      super('felteerror', { detail, cancelable: true });\n    }\n\n    errors?: AssignableErrors<Data>;\n\n    setErrors(errors: AssignableErrors<Data>) {\n      this.preventDefault();\n      this.errors = errors;\n    }\n  }\n\n  class SubmitEvent<Data extends Obj = any> extends Event {\n    constructor() {\n      super('feltesubmit', { cancelable: true });\n    }\n\n    target!: HTMLFormElement;\n\n    onSubmit?: CreateSubmitHandlerConfig<Data>['onSubmit'];\n    onError?: CreateSubmitHandlerConfig<Data>['onError'];\n    onSuccess?: CreateSubmitHandlerConfig<Data>['onSuccess'];\n\n    handleSubmit(onSubmit: CreateSubmitHandlerConfig<Data>['onSubmit']) {\n      this.onSubmit = onSubmit;\n    }\n\n    handleError(onError: CreateSubmitHandlerConfig<Data>['onError']) {\n      this.onError = onError;\n    }\n\n    handleSuccess(onSuccess: CreateSubmitHandlerConfig<Data>['onSuccess']) {\n      this.onSuccess = onSuccess;\n    }\n  }\n\n  return {\n    createErrorEvent: (detail: FelteErrorDetail<Data>) =>\n      new ErrorEvent<Data>(detail) as FelteErrorEvent<Data>,\n    createSubmitEvent: () => new SubmitEvent<Data>() as FelteSubmitEvent<Data>,\n    createSuccessEvent: (detail: FelteSuccessDetail<Data>) =>\n      new SuccessEvent<Data>(detail) as FelteSuccessEvent<Data>,\n  };\n}\n","import type {\n  Extender,\n  Obj,\n  Stores,\n  FormConfig,\n  TransformFunction,\n  ExtenderHandler,\n  FormControl,\n  CreateSubmitHandlerConfig,\n  Errors,\n  AddValidatorFn,\n  Helpers,\n  ValidationFunction,\n  Keyed,\n} from '@felte/common';\nimport {\n  isFormControl,\n  shouldIgnore,\n  isInputElement,\n  isSelectElement,\n  isElement,\n  getInputTextOrNumber,\n  _get,\n  _set,\n  _unset,\n  _merge,\n  _cloneDeep,\n  _defaultsDeep,\n  getPath,\n  deepSet,\n  deepSome,\n  getFormDefaultValues,\n  getFormControls,\n  _isPlainObject,\n  debounce,\n} from '@felte/common';\nimport type { SuccessResponse, FetchResponse } from './error';\nimport { get } from './get';\nimport { createEventConstructors } from './events';\nimport { FelteSubmitError } from './error';\nimport { deepSetTouched } from './deep-set-touched';\nimport { deepRemoveKey } from './deep-set-key';\n\nfunction createDefaultSubmitHandler(form?: HTMLFormElement) {\n  if (!form) return;\n  return async function onSubmit(): Promise<SuccessResponse> {\n    let body: FormData | URLSearchParams = new FormData(form);\n    const action = new URL(form.action);\n    const method =\n      form.method.toLowerCase() === 'get'\n        ? 'get'\n        : action.searchParams.get('_method') || form.method;\n    let enctype = form.enctype;\n\n    if (form.querySelector('input[type=\"file\"]')) {\n      enctype = 'multipart/form-data';\n    }\n    if (method === 'get' || enctype === 'application/x-www-form-urlencoded') {\n      body = new URLSearchParams(body as any);\n    }\n\n    let fetchOptions: RequestInit;\n\n    if (method === 'get') {\n      (body as URLSearchParams).forEach((value, key) => {\n        action.searchParams.append(key, value);\n      });\n      fetchOptions = { method };\n    } else {\n      fetchOptions = {\n        method,\n        body,\n        headers: {\n          'Content-Type': enctype,\n        },\n      };\n    }\n\n    const response: FetchResponse = await window.fetch(\n      action.toString(),\n      fetchOptions\n    );\n\n    if (response.ok) return response;\n    throw new FelteSubmitError(\n      'An error occurred while submitting the form',\n      response\n    );\n  };\n}\n\nexport type FormActionConfig<Data extends Obj> = {\n  stores: Stores<Data>;\n  config: FormConfig<Data>;\n  extender: Extender<Data>[];\n  validateErrors(\n    data: Data | Keyed<Data>,\n    altValidate?: ValidationFunction<Data> | ValidationFunction<Data>[]\n  ): Promise<Errors<Data> | undefined>;\n  validateWarnings(\n    data: Data | Keyed<Data>,\n    altWarn?: ValidationFunction<Data> | ValidationFunction<Data>[]\n  ): Promise<Errors<Data> | undefined>;\n  helpers: Helpers<Data, string> & {\n    addValidator: AddValidatorFn<Data>;\n    addTransformer(transformer: TransformFunction<Data>): void;\n  };\n  _setFormNode(node: HTMLFormElement): void;\n  _getFormNode(): HTMLFormElement | undefined;\n  _getInitialValues(): Data;\n  _setCurrentExtenders(extenders: ExtenderHandler<Data>[]): void;\n  _getCurrentExtenders(): ExtenderHandler<Data>[];\n};\n\nexport function createFormAction<Data extends Obj>({\n  helpers,\n  stores,\n  config,\n  extender,\n  validateErrors,\n  validateWarnings,\n  _setFormNode,\n  _getFormNode,\n  _getInitialValues,\n  _setCurrentExtenders,\n  _getCurrentExtenders,\n}: FormActionConfig<Data>) {\n  const { setFields, setTouched, reset, setInitialValues } = helpers;\n  const {\n    addValidator,\n    addTransformer,\n    validate,\n    setIsDirty,\n    setIsSubmitting,\n    ...contextHelpers\n  } = helpers;\n  const {\n    data,\n    errors,\n    warnings,\n    touched,\n    isSubmitting,\n    isDirty,\n    interacted,\n  } = stores;\n\n  function createSubmitHandler(altConfig?: CreateSubmitHandlerConfig<Data>) {\n    return async function handleSubmit(event?: Event) {\n      const formNode = _getFormNode();\n      const {\n        createErrorEvent,\n        createSubmitEvent,\n        createSuccessEvent,\n      } = createEventConstructors<Data>();\n      const submitEvent = createSubmitEvent();\n      formNode?.dispatchEvent(submitEvent);\n      const onError =\n        submitEvent.onError ?? altConfig?.onError ?? config.onError;\n      const onSuccess =\n        submitEvent.onSuccess ?? altConfig?.onSuccess ?? config.onSuccess;\n      const onSubmit =\n        submitEvent.onSubmit ??\n        altConfig?.onSubmit ??\n        config.onSubmit ??\n        createDefaultSubmitHandler(formNode);\n      if (!onSubmit) return;\n      event?.preventDefault();\n      if (submitEvent.defaultPrevented) return;\n      isSubmitting.set(true);\n      interacted.set(null);\n      const currentData = deepRemoveKey(get(data));\n      const currentErrors = await validateErrors(\n        currentData,\n        altConfig?.validate\n      );\n      const currentWarnings = await validateWarnings(\n        currentData,\n        altConfig?.warn\n      );\n      if (currentWarnings)\n        warnings.set(_merge(deepSet(currentData, []), currentWarnings));\n      touched.set(deepSetTouched(currentData, true));\n      if (currentErrors) {\n        touched.set(deepSetTouched(currentErrors as Data, true));\n        const hasErrors = deepSome(currentErrors, (error) =>\n          Array.isArray(error) ? error.length >= 1 : !!error\n        );\n        if (hasErrors) {\n          await new Promise((r) => setTimeout(r));\n          _getCurrentExtenders().forEach((extender) =>\n            extender.onSubmitError?.({\n              data: currentData,\n              errors: currentErrors,\n            })\n          );\n          isSubmitting.set(false);\n          return;\n        }\n      }\n      const context = {\n        ...contextHelpers,\n        form: formNode,\n        controls:\n          formNode && Array.from(formNode.elements).filter(isFormControl),\n        config: { ...config, ...altConfig },\n      };\n      try {\n        const response = await onSubmit(currentData, context);\n        formNode?.dispatchEvent(createSuccessEvent({ response, ...context }));\n        await onSuccess?.(response, context);\n      } catch (e) {\n        const errorEvent = createErrorEvent({ error: e, ...context });\n        formNode?.dispatchEvent(errorEvent);\n        if (!onError && !errorEvent.defaultPrevented) {\n          throw e;\n        }\n        if (!onError && !errorEvent.errors) return;\n        const serverErrors = errorEvent.errors || (await onError?.(e, context));\n        if (serverErrors) {\n          touched.set(deepSetTouched((serverErrors as unknown) as Data, true));\n          errors.set(serverErrors);\n          await new Promise((r) => setTimeout(r));\n          _getCurrentExtenders().forEach((extender) =>\n            extender.onSubmitError?.({\n              data: currentData,\n              errors: get(errors),\n            })\n          );\n        }\n      } finally {\n        isSubmitting.set(false);\n      }\n    };\n  }\n\n  const handleSubmit = createSubmitHandler();\n\n  function form(node: HTMLFormElement) {\n    if (!node.requestSubmit)\n      node.requestSubmit = handleSubmit as typeof node.requestSubmit;\n    function callExtender(stage: 'MOUNT' | 'UPDATE') {\n      return function (extender: Extender<Data>) {\n        return extender({\n          form: node,\n          stage,\n          controls: Array.from(node.elements).filter(isFormControl),\n          data,\n          errors,\n          warnings,\n          touched,\n          config,\n          addValidator,\n          addTransformer,\n          setFields,\n          validate,\n          reset,\n        });\n      };\n    }\n\n    _setCurrentExtenders(extender.map(callExtender('MOUNT')));\n    node.noValidate = !!config.validate;\n    const { defaultData, defaultTouched } = getFormDefaultValues<Data>(node);\n    _setFormNode(node);\n    setInitialValues(_merge(_cloneDeep(defaultData), _getInitialValues()));\n    setFields(_getInitialValues());\n    touched.set(defaultTouched);\n\n    function setCheckboxValues(target: HTMLInputElement) {\n      const elPath = getPath(target);\n      const checkboxes = Array.from(\n        node.querySelectorAll(`[name=\"${target.name}\"]`)\n      ).filter((checkbox) => {\n        if (!isFormControl(checkbox)) return false;\n        return elPath === getPath(checkbox);\n      });\n      if (checkboxes.length === 0) return;\n      if (checkboxes.length === 1) {\n        return data.update(($data) =>\n          _set($data, getPath(target), target.checked)\n        );\n      }\n      return data.update(($data) => {\n        return _set(\n          $data,\n          getPath(target),\n          checkboxes\n            .filter(isInputElement)\n            .filter((el: HTMLInputElement) => el.checked)\n            .map((el: HTMLInputElement) => el.value)\n        );\n      });\n    }\n\n    function setRadioValues(target: HTMLInputElement) {\n      const radios = node.querySelectorAll(`[name=\"${target.name}\"]`);\n      const checkedRadio = Array.from(radios).find(\n        (el) => isInputElement(el) && el.checked\n      ) as HTMLInputElement | undefined;\n      data.update(($data) => _set($data, getPath(target), checkedRadio?.value));\n    }\n\n    function setFileValue(target: HTMLInputElement) {\n      const files = Array.from(target.files ?? []);\n      data.update(($data) => {\n        return _set($data, getPath(target), target.multiple ? files : files[0]);\n      });\n    }\n\n    function setSelectValue(target: HTMLSelectElement) {\n      if (!target.multiple) {\n        data.update(($data) => {\n          return _set($data, getPath(target), target.value);\n        });\n      } else {\n        const selectedOptions = Array.from(target.options)\n          .filter((opt) => opt.selected)\n          .map((opt) => opt.value);\n        data.update(($data) => {\n          return _set($data, getPath(target), selectedOptions);\n        });\n      }\n    }\n\n    function handleInput(e: Event) {\n      const target = e.target;\n      if (\n        !target ||\n        !isFormControl(target) ||\n        isSelectElement(target) ||\n        shouldIgnore(target)\n      )\n        return;\n      if (['checkbox', 'radio', 'file'].includes(target.type)) return;\n      if (!target.name) return;\n      isDirty.set(true);\n      const inputValue = getInputTextOrNumber(target);\n      interacted.set(target.name);\n      data.update(($data) => {\n        return _set($data, getPath(target), inputValue);\n      });\n    }\n\n    function handleChange(e: Event) {\n      const target = e.target;\n      if (!target || !isFormControl(target) || shouldIgnore(target)) return;\n      if (!target.name) return;\n      setTouched<string, any>(getPath(target), true);\n      interacted.set(target.name);\n      if (\n        isSelectElement(target) ||\n        ['checkbox', 'radio', 'file', 'hidden'].includes(target.type)\n      ) {\n        isDirty.set(true);\n      }\n      if (target.type === 'hidden') {\n        data.update(($data) => {\n          return _set($data, getPath(target), target.value);\n        });\n      }\n      if (isSelectElement(target)) setSelectValue(target);\n      else if (!isInputElement(target)) return;\n      else if (target.type === 'checkbox') setCheckboxValues(target);\n      else if (target.type === 'radio') setRadioValues(target);\n      else if (target.type === 'file') setFileValue(target);\n    }\n\n    function handleBlur(e: Event) {\n      const target = e.target;\n      if (!target || !isFormControl(target) || shouldIgnore(target)) return;\n      if (!target.name) return;\n      setTouched<string, any>(getPath(target), true);\n      interacted.set(target.name);\n    }\n\n    function handleReset(e: Event) {\n      e.preventDefault();\n      reset();\n    }\n\n    const mutationOptions = { childList: true, subtree: true };\n\n    function unsetTaggedForRemove(formControls: FormControl[]) {\n      let currentData = get(data);\n      let currentTouched = get(touched);\n      let currentErrors = get(errors);\n      let currentWarnings = get(warnings);\n      for (const control of formControls.reverse()) {\n        if (\n          control.hasAttribute('data-felte-keep-on-remove') &&\n          control.dataset.felteKeepOnRemove !== 'false'\n        )\n          continue;\n        const fieldArrayReg = /.*(\\[[0-9]+\\]|\\.[0-9]+)\\.[^.]+$/;\n        let fieldName = getPath(control);\n        const shape = get(touched);\n        const isFieldArray = fieldArrayReg.test(fieldName);\n        if (isFieldArray) {\n          const arrayPath = fieldName.split('.').slice(0, -1).join('.');\n          const valueToRemove = _get(shape, arrayPath);\n          if (\n            _isPlainObject(valueToRemove) &&\n            Object.keys(valueToRemove).length <= 1\n          ) {\n            fieldName = arrayPath;\n          }\n        }\n        currentData = _unset(currentData, fieldName);\n        currentTouched = _unset(currentTouched, fieldName);\n        currentErrors = _unset(currentErrors, fieldName);\n        currentWarnings = _unset(currentWarnings, fieldName);\n      }\n      data.set(currentData as Data);\n      touched.set(currentTouched);\n      errors.set(currentErrors);\n      warnings.set(currentWarnings);\n    }\n\n    const updateAddedNodes = debounce(() => {\n      _getCurrentExtenders().forEach((extender) => extender.destroy?.());\n      _setCurrentExtenders(extender.map(callExtender('UPDATE')));\n      const {\n        defaultData: newDefaultData,\n        defaultTouched: newDefaultTouched,\n      } = getFormDefaultValues<Data>(node);\n      data.update(($data) => _defaultsDeep<Data>($data, newDefaultData));\n      touched.update(($touched) => {\n        return _defaultsDeep($touched, newDefaultTouched);\n      });\n    }, 0);\n\n    let removedFormControls: FormControl[] = [];\n\n    const updateRemovedNodes = debounce(() => {\n      _getCurrentExtenders().forEach((extender) => extender.destroy?.());\n      _setCurrentExtenders(extender.map(callExtender('UPDATE')));\n      unsetTaggedForRemove(removedFormControls);\n      removedFormControls = [];\n    }, 0);\n\n    function mutationCallback(mutationList: MutationRecord[]) {\n      for (const mutation of mutationList) {\n        if (mutation.type !== 'childList') continue;\n        if (mutation.addedNodes.length > 0) {\n          const shouldUpdate = Array.from(mutation.addedNodes).some((node) => {\n            if (!isElement(node)) return false;\n            if (isFormControl(node)) return true;\n            const formControls = getFormControls(node);\n            return formControls.length > 0;\n          });\n          if (!shouldUpdate) continue;\n          updateAddedNodes();\n        }\n        if (mutation.removedNodes.length > 0) {\n          for (const removedNode of mutation.removedNodes) {\n            if (!isElement(removedNode)) continue;\n            const formControls = getFormControls(removedNode);\n            if (formControls.length === 0) continue;\n            removedFormControls.push(...formControls);\n            updateRemovedNodes();\n          }\n        }\n      }\n    }\n\n    const observer = new MutationObserver(mutationCallback);\n\n    observer.observe(node, mutationOptions);\n    node.addEventListener('input', handleInput);\n    node.addEventListener('change', handleChange);\n    node.addEventListener('focusout', handleBlur);\n    node.addEventListener('submit', handleSubmit);\n    node.addEventListener('reset', handleReset);\n    const unsubscribeErrors = errors.subscribe(($errors) => {\n      for (const el of node.elements) {\n        if (!isFormControl(el) || !el.name) continue;\n        const fieldErrors = _get($errors, getPath(el));\n        const message = Array.isArray(fieldErrors)\n          ? fieldErrors.join('\\n')\n          : typeof fieldErrors === 'string'\n          ? fieldErrors\n          : undefined;\n        if (message === el.dataset.felteValidationMessage) continue;\n        if (message) {\n          el.dataset.felteValidationMessage = message;\n          el.setAttribute('aria-invalid', 'true');\n        } else {\n          delete el.dataset.felteValidationMessage;\n          el.removeAttribute('aria-invalid');\n        }\n      }\n    });\n\n    return {\n      destroy() {\n        observer.disconnect();\n        node.removeEventListener('input', handleInput);\n        node.removeEventListener('change', handleChange);\n        node.removeEventListener('focusout', handleBlur);\n        node.removeEventListener('submit', handleSubmit);\n        node.removeEventListener('reset', handleReset);\n        unsubscribeErrors();\n        _getCurrentExtenders().forEach((extender) => extender.destroy?.());\n      },\n    };\n  }\n\n  return {\n    form,\n    createSubmitHandler,\n    handleSubmit,\n  };\n}\n","import type {\n  StoreFactory,\n  Obj,\n  Keyed,\n  FormConfig,\n  Errors,\n  Touched,\n  ValidationFunction,\n  PartialWritableErrors,\n  AssignableErrors,\n  KeyedWritable,\n} from '@felte/common';\nimport type { Writable, Readable, Unsubscriber } from 'svelte/store';\nimport {\n  _cloneDeep,\n  deepSet,\n  _isPlainObject,\n  _mergeWith,\n  runValidations,\n  mergeErrors,\n  executeTransforms,\n  deepSome,\n  debounce,\n} from '@felte/common';\nimport { deepSetTouched } from './deep-set-touched';\nimport { deepRemoveKey, deepSetKey } from './deep-set-key';\n\ntype ValidationController = {\n  signal: {\n    readonly aborted: boolean;\n    readonly priority: boolean;\n  };\n  abort(): void;\n};\n\nfunction createValidationController(priority: boolean): ValidationController {\n  const signal = { aborted: false, priority };\n  return {\n    signal,\n    abort() {\n      signal.aborted = true;\n    },\n  };\n}\n\nexport function errorFilterer(touchValue?: unknown, errValue?: unknown) {\n  if (_isPlainObject(touchValue)) {\n    if (\n      !errValue ||\n      (_isPlainObject(errValue) && Object.keys(errValue).length === 0)\n    ) {\n      return deepSet(touchValue, null);\n    }\n    return;\n  }\n  if (Array.isArray(touchValue)) {\n    if (touchValue.some(_isPlainObject)) return;\n    const errArray = Array.isArray(errValue) ? errValue : [];\n    return touchValue.map((value, index) => {\n      const err = errArray[index];\n      if (Array.isArray(err) && err.length === 0) return null;\n      return (value && err) || null;\n    });\n  }\n  if (Array.isArray(errValue) && errValue.length === 0) return null;\n  if (Array.isArray(errValue)) return touchValue ? errValue : null;\n  return touchValue && errValue ? [errValue] : null;\n}\n\nexport function warningFilterer(touchValue?: unknown, errValue?: unknown) {\n  if (_isPlainObject(touchValue)) {\n    if (\n      !errValue ||\n      (_isPlainObject(errValue) && Object.keys(errValue).length === 0)\n    ) {\n      return deepSet(touchValue, null);\n    }\n    return;\n  }\n  if (Array.isArray(touchValue)) {\n    if (touchValue.some(_isPlainObject)) return;\n    const errArray = Array.isArray(errValue) ? errValue : [];\n    return touchValue.map((_, index) => {\n      const err = errArray[index];\n      if (Array.isArray(err) && err.length === 0) return null;\n      return err || null;\n    });\n  }\n  if (Array.isArray(errValue) && errValue.length === 0) return null;\n  if (Array.isArray(errValue)) return errValue;\n  return errValue ? [errValue] : null;\n}\n\nfunction filterErrors<Data extends Obj>([errors, touched]: [\n  Errors<Data>,\n  Touched<Data>\n]) {\n  return _mergeWith<Errors<Data>>(touched, errors, errorFilterer);\n}\n\nfunction filterWarnings<Data extends Obj>([errors, touched]: [\n  Errors<Data>,\n  Touched<Data>\n]) {\n  return _mergeWith<Errors<Data>>(touched, errors, warningFilterer);\n}\n\ntype Readables =\n  | Readable<any>\n  | [Readable<any>, ...Array<Readable<any>>]\n  | Array<Readable<any>>;\n\ntype ReadableValues<T> = T extends Readable<infer U>\n  ? [U]\n  : { [K in keyof T]: T[K] extends Readable<infer U> ? U : never };\n\ntype PossibleWritable<T> = Readable<T> & {\n  update?: (updater: (v: T) => T) => void;\n  set?: (v: T) => void;\n};\n\n// A `derived` store factory that can defer subscription and be constructed\n// with any store factory.\nexport function createDerivedFactory<StoreExt = Record<string, any>>(\n  storeFactory: StoreFactory<StoreExt>\n) {\n  return function derived<R, T extends Readables = Readables>(\n    storeOrStores: T,\n    deriver: (values: ReadableValues<T>) => R,\n    initialValue: R\n  ): [PossibleWritable<R> & StoreExt, () => void, () => void] {\n    const stores: Readable<any>[] = Array.isArray(storeOrStores)\n      ? storeOrStores\n      : [storeOrStores];\n    const values: any[] = new Array(stores.length);\n    const derivedStore: PossibleWritable<R> & StoreExt = storeFactory(\n      initialValue\n    );\n\n    const storeSet = derivedStore.set as Writable<R>['set'];\n    const storeSubscribe = derivedStore.subscribe;\n    let unsubscribers: Unsubscriber[] | undefined;\n\n    function startStore() {\n      unsubscribers = stores.map((store, index) => {\n        return store.subscribe(($store: any) => {\n          values[index] = $store;\n          storeSet(deriver(values as ReadableValues<T>));\n        });\n      });\n    }\n\n    function stopStore() {\n      unsubscribers?.forEach((unsub) => unsub());\n    }\n\n    derivedStore.subscribe = function subscribe(\n      subscriber: (value: R) => void\n    ) {\n      const unsubscribe = storeSubscribe(subscriber);\n      return () => {\n        unsubscribe();\n      };\n    };\n\n    return [derivedStore, startStore, stopStore];\n  };\n}\n\nexport function createStores<Data extends Obj, StoreExt = Record<string, any>>(\n  storeFactory: StoreFactory<StoreExt>,\n  config: FormConfig<Data> & { preventStoreStart?: boolean }\n) {\n  const derived = createDerivedFactory(storeFactory);\n  const initialValues = (config.initialValues = config.initialValues\n    ? deepSetKey(\n        executeTransforms(\n          _cloneDeep(config.initialValues as Data),\n          config.transform\n        )\n      )\n    : ({} as Data));\n  const initialTouched = deepSetTouched(deepRemoveKey(initialValues), false);\n  const touched = storeFactory(initialTouched);\n\n  const validationCount = storeFactory(0);\n  const [isValidating, startIsValidating, stopIsValidating] = derived(\n    [touched, validationCount],\n    ([$touched, $validationCount]) => {\n      const isTouched = deepSome($touched as Obj, (t) => !!t);\n      return isTouched && $validationCount >= 1;\n    },\n    false\n  );\n\n  // It is important not to destructure stores created with the factory\n  // since some stores may be callable.\n  delete isValidating.set;\n  delete isValidating.update;\n\n  function cancellableValidation<Data extends Obj>(\n    store: PartialWritableErrors<Data>\n  ) {\n    let activeController: ValidationController | undefined;\n    return async function executeValidations(\n      $data: Data,\n      shape: Errors<Data>,\n      validations?: ValidationFunction<Data>[] | ValidationFunction<Data>,\n      priority = false\n    ) {\n      if (!validations || !$data) return;\n      let current =\n        shape && Object.keys(shape).length > 0\n          ? shape\n          : (deepSet($data, []) as Errors<Data>);\n\n      // Keeping a controller allows us to cancel previous asynchronous\n      // validations if they've become stale.\n      const controller = createValidationController(priority);\n\n      // By assigning `priority` we can prevent specific validations\n      // from being aborted. Used when submitting the form or\n      // calling the `validate` helper.\n      if (!activeController?.signal.priority || priority) {\n        activeController?.abort();\n        activeController = controller;\n      }\n\n      // If the current controller has priority and we're not trying to\n      // override it, completely prevent validations\n      if (activeController.signal.priority && !priority) return;\n      validationCount.update((c) => c + 1);\n      const results = runValidations($data, validations);\n      results.forEach(async (promise: any) => {\n        const result = await promise;\n        if (controller.signal.aborted) return;\n        current = mergeErrors([current, result]);\n        store.set(current);\n      });\n      await Promise.all(results);\n      activeController = undefined;\n      validationCount.update((c) => c - 1);\n      return current;\n    };\n  }\n\n  let storesShape = deepSet(initialTouched, []) as Errors<Data>;\n  const data = storeFactory(initialValues);\n\n  const initialErrors = deepSet(initialTouched, []) as Errors<Data>;\n  const immediateErrors = storeFactory(\n    initialErrors\n  ) as PartialWritableErrors<Data> & StoreExt;\n  const debouncedErrors = storeFactory(\n    _cloneDeep(initialErrors)\n  ) as PartialWritableErrors<Data> & StoreExt;\n  const [errors, startErrors, stopErrors] = derived<Errors<Data>>(\n    [\n      immediateErrors as Readable<Errors<Data>>,\n      debouncedErrors as Readable<Errors<Data>>,\n    ],\n    mergeErrors,\n    _cloneDeep(initialErrors)\n  );\n\n  const initialWarnings = deepSet(initialTouched, []) as Errors<Data>;\n  const immediateWarnings = storeFactory(\n    initialWarnings\n  ) as PartialWritableErrors<Data> & StoreExt;\n  const debouncedWarnings = storeFactory(\n    _cloneDeep(initialWarnings)\n  ) as PartialWritableErrors<Data> & StoreExt;\n  const [warnings, startWarnings, stopWarnings] = derived<Errors<Data>>(\n    [\n      immediateWarnings as Readable<Errors<Data>>,\n      debouncedWarnings as Readable<Errors<Data>>,\n    ],\n    mergeErrors,\n    _cloneDeep(initialWarnings)\n  );\n\n  const [filteredErrors, startFilteredErrors, stopFilteredErrors] = derived(\n    [errors as Readable<Errors<Data>>, touched as Readable<Touched<Data>>],\n    filterErrors,\n    _cloneDeep(initialErrors)\n  );\n\n  const [\n    filteredWarnings,\n    startFilteredWarnings,\n    stopFilteredWarnings,\n  ] = derived(\n    [warnings as Readable<Errors<Data>>, touched as Readable<Touched<Data>>],\n    filterWarnings,\n    _cloneDeep(initialWarnings)\n  );\n\n  // This is necessary since, on the first run, validations\n  // have not run yet. We assume the form is not valid in the first calling\n  // if there's validation functions assigned in the configuration.\n  let firstCalled = false;\n  const [isValid, startIsValid, stopIsValid] = derived(\n    errors,\n    ([$errors]) => {\n      if (!firstCalled) {\n        firstCalled = true;\n        return !config.validate && !config.debounced?.validate;\n      } else {\n        return !deepSome($errors, (error) =>\n          Array.isArray(error) ? error.length >= 1 : !!error\n        );\n      }\n    },\n    !config.validate && !config.debounced?.validate\n  );\n\n  delete isValid.set;\n  delete isValid.update;\n\n  const isSubmitting = storeFactory(false);\n\n  const isDirty = storeFactory(false);\n\n  const interacted = storeFactory<string | null>(null);\n\n  const validateErrors = cancellableValidation(immediateErrors);\n  const validateWarnings = cancellableValidation(immediateWarnings);\n  const validateDebouncedErrors = cancellableValidation(debouncedErrors);\n  const validateDebouncedWarnings = cancellableValidation(debouncedWarnings);\n  const _validateDebouncedErrors = debounce(\n    validateDebouncedErrors,\n    config.debounced?.validateTimeout ?? config.debounced?.timeout ?? 300\n  );\n  const _validateDebouncedWarnings = debounce(\n    validateDebouncedWarnings,\n    config.debounced?.warnTimeout ?? config.debounced?.timeout ?? 300\n  );\n\n  async function executeErrorsValidation(\n    data: Data | Keyed<Data>,\n    altValidate?: ValidationFunction<Data> | ValidationFunction<Data>[]\n  ): Promise<Errors<Data> | undefined> {\n    const $data = deepRemoveKey(data);\n    const errors = validateErrors(\n      $data,\n      storesShape,\n      altValidate ?? config.validate,\n      true\n    );\n    if (altValidate) return errors;\n    const debouncedErrors = validateDebouncedErrors(\n      $data,\n      storesShape,\n      config.debounced?.validate,\n      true\n    );\n    return mergeErrors<Errors<Data>>(\n      await Promise.all([errors, debouncedErrors])\n    );\n  }\n\n  async function executeWarningsValidation(\n    data: Data | Keyed<Data>,\n    altWarn?: ValidationFunction<Data> | ValidationFunction<Data>[]\n  ): Promise<Errors<Data> | undefined> {\n    const $data = deepRemoveKey(data);\n    const warnings = validateWarnings(\n      $data,\n      storesShape,\n      altWarn ?? config.warn,\n      true\n    );\n    if (altWarn) return warnings;\n    const debouncedWarnings = validateDebouncedWarnings(\n      $data,\n      storesShape,\n      config.debounced?.warn,\n      true\n    );\n    return mergeErrors<Errors<Data>>(\n      await Promise.all([warnings, debouncedWarnings])\n    );\n  }\n\n  let errorsValue = initialErrors;\n  let warningsValue = initialWarnings;\n  function start() {\n    const dataUnsubscriber = data.subscribe(($keyedData) => {\n      const $data = deepRemoveKey($keyedData);\n      validateErrors($data, storesShape, config.validate);\n      validateWarnings($data, storesShape, config.warn);\n      _validateDebouncedErrors($data, storesShape, config.debounced?.validate);\n      _validateDebouncedWarnings($data, storesShape, config.debounced?.warn);\n    });\n\n    const unsubscribeTouched = touched.subscribe(($touched) => {\n      storesShape = deepSet($touched, []) as Errors<Data>;\n    });\n    const unsubscribeErrors = errors.subscribe(($errors) => {\n      errorsValue = $errors;\n    });\n    const unsubscribeWarnings = warnings.subscribe(($warnings) => {\n      warningsValue = $warnings;\n    });\n\n    startErrors();\n    startIsValid();\n    startWarnings();\n    startFilteredErrors();\n    startFilteredWarnings();\n    startIsValidating();\n\n    function cleanup() {\n      dataUnsubscriber();\n      stopFilteredErrors();\n      stopErrors();\n      stopWarnings();\n      stopFilteredWarnings();\n      stopIsValid();\n      stopIsValidating();\n      unsubscribeTouched();\n      unsubscribeErrors();\n      unsubscribeWarnings();\n    }\n    return cleanup;\n  }\n\n  function publicErrorsUpdater(\n    updater: (value: Errors<Data>) => AssignableErrors<Data>\n  ): void {\n    immediateErrors.set(updater(errorsValue));\n    debouncedErrors.set({} as AssignableErrors<Data>);\n  }\n\n  function publicWarningsUpdater(\n    updater: (value: Errors<Data>) => AssignableErrors<Data>\n  ): void {\n    immediateWarnings.set(updater(warningsValue));\n    debouncedWarnings.set({} as AssignableErrors<Data>);\n  }\n\n  function publicErrorsSetter(value: AssignableErrors<Data>): void {\n    publicErrorsUpdater(() => value);\n  }\n\n  function publicWarningsSetter(value: AssignableErrors<Data>): void {\n    publicWarningsUpdater(() => value);\n  }\n\n  filteredErrors.set = publicErrorsSetter;\n  (filteredErrors as PartialWritableErrors<Data>).update = publicErrorsUpdater;\n  filteredWarnings.set = publicWarningsSetter;\n  (filteredWarnings as PartialWritableErrors<Data>).update = publicWarningsUpdater;\n\n  return {\n    data: data as KeyedWritable<Data> & StoreExt,\n    errors: filteredErrors as PartialWritableErrors<Data> & StoreExt,\n    warnings: filteredWarnings as PartialWritableErrors<Data> & StoreExt,\n    touched,\n    isValid,\n    isSubmitting,\n    isDirty,\n    isValidating,\n    interacted,\n    validateErrors: executeErrorsValidation,\n    validateWarnings: executeWarningsValidation,\n    cleanup: config.preventStoreStart ? () => undefined : start(),\n    start,\n  };\n}\n","import type {\n  Form,\n  FormConfig,\n  FormConfigWithTransformFn,\n  FormConfigWithoutTransformFn,\n  ExtenderHandler,\n  StoreFactory,\n  Obj,\n  ValidationFunction,\n  TransformFunction,\n  UnknownStores,\n  Stores,\n  KnownStores,\n  Helpers,\n  UnknownHelpers,\n  KnownHelpers,\n  ValidatorOptions,\n} from '@felte/common';\nimport { executeTransforms } from '@felte/common';\nimport { createHelpers } from './helpers';\nimport { createFormAction } from './create-form-action';\nimport type { FormActionConfig } from './create-form-action';\nimport { createStores } from './stores';\nimport { deepSetKey } from './deep-set-key';\n\nexport type Adapters<StoreExt = Record<string, any>> = {\n  storeFactory: StoreFactory<StoreExt>;\n};\n\nexport type CoreForm<Data extends Obj = any> = Form<Data> & {\n  cleanup(): void;\n  startStores(): () => void;\n};\n\nexport function createForm<\n  Data extends Obj = Obj,\n  Ext extends Obj = Obj,\n  StoreExt = Record<string, any>\n>(\n  config: FormConfigWithTransformFn<Data> & Ext,\n  adapters: Adapters<StoreExt>\n): CoreForm<Data> & UnknownHelpers<Data> & UnknownStores<Data, StoreExt>;\nexport function createForm<\n  Data extends Obj = Obj,\n  Ext extends Obj = Obj,\n  StoreExt = Record<string, any>\n>(\n  config: FormConfigWithoutTransformFn<Data> & Ext,\n  adapters: Adapters<StoreExt>\n): CoreForm<Data> & KnownHelpers<Data> & KnownStores<Data, StoreExt>;\nexport function createForm<\n  Data extends Obj = Obj,\n  Ext extends Obj = Obj,\n  StoreExt = Record<string, any>\n>(\n  config: FormConfig<Data> & Ext,\n  adapters: Adapters<StoreExt>\n): CoreForm<Data> & Helpers<Data> & Stores<Data, StoreExt>;\nexport function createForm<\n  Data extends Obj = Obj,\n  Ext extends Obj = Obj,\n  StoreExt = Record<string, any>\n>(\n  config: FormConfig<Data> & { preventStoreStart?: boolean } & Ext,\n  adapters: Adapters<StoreExt>\n): CoreForm<Data> & Helpers<Data> & Stores<Data, StoreExt> {\n  config.extend ??= [];\n  config.debounced ??= {};\n  if (config.validate && !Array.isArray(config.validate))\n    config.validate = [config.validate];\n\n  if (config.debounced.validate && !Array.isArray(config.debounced.validate))\n    config.debounced.validate = [config.debounced.validate];\n\n  if (config.transform && !Array.isArray(config.transform))\n    config.transform = [config.transform];\n\n  if (config.warn && !Array.isArray(config.warn)) config.warn = [config.warn];\n  if (config.debounced.warn && !Array.isArray(config.debounced.warn))\n    config.debounced.warn = [config.debounced.warn];\n\n  function addValidator(\n    validator: ValidationFunction<Data>,\n    { debounced, level }: ValidatorOptions = {\n      debounced: false,\n      level: 'error',\n    }\n  ) {\n    const prop = level === 'error' ? 'validate' : 'warn';\n    config.debounced ??= {};\n    const validateConfig = debounced ? config.debounced : config;\n    if (!validateConfig[prop]) {\n      validateConfig[prop] = [validator];\n    } else {\n      validateConfig[prop] = [\n        ...(validateConfig[prop] as ValidationFunction<Data>[]),\n        validator,\n      ];\n    }\n  }\n\n  function addTransformer(transformer: TransformFunction<Data>) {\n    if (!config.transform) {\n      (config as FormConfig<Data>).transform = [transformer];\n    } else {\n      config.transform = [\n        ...(config.transform as TransformFunction<Data>[]),\n        transformer,\n      ];\n    }\n  }\n\n  const extender = Array.isArray(config.extend)\n    ? config.extend\n    : [config.extend];\n\n  let currentExtenders: ExtenderHandler<Data>[] = [];\n  const {\n    isSubmitting,\n    isValidating,\n    data,\n    errors,\n    warnings,\n    touched,\n    isValid,\n    isDirty,\n    cleanup,\n    start,\n    validateErrors,\n    validateWarnings,\n    interacted,\n  } = createStores(adapters.storeFactory, config);\n  const originalUpdate = data.update;\n  const originalSet = data.set;\n\n  const transUpdate: typeof data.update = (updater) =>\n    originalUpdate((values) =>\n      deepSetKey(executeTransforms(updater(values), config.transform))\n    );\n  const transSet: typeof data.set = (values) =>\n    originalSet(deepSetKey(executeTransforms(values, config.transform)));\n\n  data.update = transUpdate;\n  data.set = transSet;\n\n  const helpers = createHelpers<Data>({\n    extender,\n    config,\n    addValidator,\n    addTransformer,\n    validateErrors,\n    validateWarnings,\n    stores: {\n      data,\n      errors,\n      warnings,\n      touched,\n      isValid,\n      isValidating,\n      isSubmitting,\n      isDirty,\n      interacted,\n    },\n  });\n\n  currentExtenders = extender.map((extender) =>\n    extender({\n      stage: 'SETUP',\n      errors,\n      warnings,\n      touched,\n      data,\n      config,\n      addValidator,\n      addTransformer,\n      setFields: helpers.public.setFields,\n      reset: helpers.public.reset,\n      validate: helpers.public.validate,\n    })\n  );\n\n  const _getCurrentExtenders = () => currentExtenders;\n  const _setCurrentExtenders = (extenders: ExtenderHandler<Data>[]) => {\n    currentExtenders = extenders;\n  };\n\n  const formActionConfig: FormActionConfig<Data> = {\n    config,\n    stores: {\n      data,\n      touched,\n      errors,\n      warnings,\n      isSubmitting,\n      isValidating,\n      isValid,\n      isDirty,\n      interacted,\n    },\n    helpers: {\n      ...helpers.public,\n      addTransformer,\n      addValidator,\n    },\n    extender,\n    validateErrors,\n    validateWarnings,\n    _getCurrentExtenders,\n    _setCurrentExtenders,\n    ...helpers.private,\n  };\n\n  const { form, createSubmitHandler, handleSubmit } = createFormAction<Data>(\n    formActionConfig\n  );\n\n  return {\n    data,\n    errors,\n    warnings,\n    touched,\n    isValid,\n    isSubmitting,\n    isValidating,\n    isDirty,\n    interacted,\n    form,\n    handleSubmit,\n    createSubmitHandler,\n    cleanup,\n    startStores: start,\n    ...helpers.public,\n  };\n}\n"],"names":["setControlValue","isFormControl","isElement","_mapValues","_isPlainObject","createId","_update","_get","_set","setForm","deepSet","_unset","_cloneDeep","_merge","deepSome","getFormDefaultValues","getPath","isInputElement","isSelectElement","shouldIgnore","getInputTextOrNumber","debounce","_defaultsDeep","getFormControls","_mergeWith","executeTransforms","runValidations","mergeErrors"],"mappings":"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"}